# 输入输出设备
## IO控制方式
### 程序直接控制

这是主机与外设间进行信息交换的最简单的方式，输入和输出完全是通过CPU执行程序来完成的。

一旦某一外设被选中并启动后，主机将查询这个外设的某些状态位，看其是否准备就绪？若外设未准备就绪，主机将再次查询；若外设已准备就绪，则执行一次I/O操作（一个字节）。

### 中断控制

- 在主机启动外设后，无须等待查询，而是继续执行原来的程序；
- 外设在做好输入输出准备时，向主机发中断请求；
- 主机接到请求后就暂时中止原来执行的程序，转去执行中断服务程序对外部请求进行处理；
- CPU检查完成状态，若出错则进行出错处理；
- 否则从I/O控制器中读出“字”并向内存中写入“字”
- 在中断处理完毕后返回原来的程序继续执行。

- 显然，程序中断不仅适用于外部设备的输入输出操作，也适用于对外界发生的随机事件的处理。
- 完成一次程序中断还需要许多辅助操作，主要适用于中、低速外设。

### DMA

- 外设可通过DMA控制器向CPU发出DMA请求：
- CPU响应DMA请求，把总线控制权交给DMA控制器；
- 由DMA控制器发送存储器地址，并决定传送数据块的长度；
- 执行DMA传送；
- DMA操作结束，并把总线控制权交还CPU。

### IO通道

- 在用户程序中使用访管指令进入管理程序，由CPU通过管理程序组织一个通道程序，并启动通道。
- 通道执行CPU为它组织的通道程序，完成指定的数据输入输出工作。
- 通道程序结束后向CPU发中断请求。CPU响应这个中断请求后，第二次进入操作系统，调用管理程序对中断请求进行处理。

### 优缺点
1. 程序直接控制方式
- 缺点：
    - CPU和IO设备之间只能串行工作
    - CPU在同一段时间内只能和一台外设交互，无法实现设备间的并行工作
    - 无法发现由设备和其他硬件所产生的错误
2. 中断控制方式
- 优点：
    - 解决了主机和外设并行工作的问题；尤其是慢的外设
    - 能充分发挥处理器的使用效率；CPU不用无限查询等待
    - 提高系统的实时能力
- 缺点
    - 中断驱动I/O是以字节为单位进行I/O的，每完成一个字节的I/O，控制器便要向CPU请求一次中断。若从磁盘读出1KB的数据块，需要中断1K次CPU
3. DMA控制方式
- 优点：
    - 数据传输的基本单位是数据块，即CPU与I/O设备之间，每次传送至少是一个数据块
    - 所传送的数据是从设备直接送入内存的，或者相反；不需CPU
    - 仅在传送一个或多个数据块的开始或结束时，才需CPU干预，整块数据的传送是在DMA控制器的控制下完成的。
- 缺点：
    - DMA方式对外围设备的管理和某些操作仍由CPU控制，当外设种类数量较多时，控制也很复杂；
    - 多个DMA控制器的同时使用会引起内存地址的冲突，并使控制过程进一步复杂化。
    - 多个DMA同时使用也不经济。
4. I/O通道控制方式


